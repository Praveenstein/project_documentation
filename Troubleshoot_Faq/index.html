
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.4.0, mkdocs-material-8.5.6" name="generator"/>
<title>Troubleshooting &amp; FAQ - SMDDC 2.0 IIOT Project Documentation</title>
<link href="../assets/stylesheets/main.20d9efc8.min.css" rel="stylesheet"/>
<link href="../assets/stylesheets/palette.cbb835fc.min.css" rel="stylesheet"/>
<meta content="#009485" name="theme-color"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gdesc-inner { font-size: 0.75rem; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            
                .gscrollbar-fixer { padding-right: 15px; }
                </style><script src="../assets/javascripts/glightbox.min.js"></script></head>
<body data-md-color-accent="teal" data-md-color-primary="teal" data-md-color-scheme="" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#troubleshooting-faq">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="SMDDC 2.0 IIOT Project Documentation" class="md-header__button md-logo" data-md-component="logo" href=".." title="SMDDC 2.0 IIOT Project Documentation">
<img alt="logo" src="../images/cmti_logo_full_white_no_border.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            SMDDC 2.0 IIOT Project Documentation
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Troubleshooting &amp; FAQ
            
          </span>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="SMDDC 2.0 IIOT Project Documentation" class="md-nav__button md-logo" data-md-component="logo" href=".." title="SMDDC 2.0 IIOT Project Documentation">
<img alt="logo" src="../images/cmti_logo_full_white_no_border.png"/>
</a>
    SMDDC 2.0 IIOT Project Documentation
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="..">
        Project Overview
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../user_interfaces/">
        User Interface
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Technical%20Stack/">
        Technical Stack
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Code%20%26%20Services%20Locations/">
        Codes &amp; Services Location
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5">
          Code Explanation
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Code Explanation" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
          Code Explanation
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../Code%20Explanation/Collector/">
        Collector Services
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Code%20Explanation/Back%20End/">
        Back End Services
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" id="__nav_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6">
          General Knowledge
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="General Knowledge" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
          General Knowledge
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../General%20Knowledge/OPC%20UA/">
        Opc Ua
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../General%20Knowledge/KPI%20in%20Manufacturing/">
        KPIs in Manufacturing
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../General%20Knowledge/Focas/">
        Focas
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" id="__nav_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_7">
          Project Knowledge
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Project Knowledge" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_7">
<span class="md-nav__icon md-icon"></span>
          Project Knowledge
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../Project%20Knowledge/Machines/">
        Machines
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Project%20Knowledge/KPI%20Calculations/">
        KPIs Calculations
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Project%20Knowledge/KPI%20Calculations%20%28CMTI%29/">
        KPIs Calculations (CMTI)
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          Troubleshooting &amp; FAQ
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        Troubleshooting &amp; FAQ
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#introduction">
    Introduction
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-to-add-new-machine">
    How to add new machine??
  </a>
<nav aria-label="How to add new machine??" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#cnc-machine-with-mtlinki">
    CNC machine with MtLinki
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#spm-machines">
    SPM machines
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-to-change-anomaly-detection-algorithm-for-dynamic-parameters">
    How to change anomaly detection algorithm for dynamic parameters??
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-to-remove-existing-axisparameter-of-a-machine">
    How to remove existing axis/parameter of a machine??
  </a>
<nav aria-label="How to remove existing axis/parameter of a machine??" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#cnc-machine-with-mtlinki_1">
    CNC machine with MtLinki
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-to-restart-services-and-check-it-status">
    How to restart services (and check it status)??
  </a>
<nav aria-label="How to restart services (and check it status)??" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#check-the-status">
    Check the Status
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#restart-the-service">
    Restart the Service
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#introduction">
    Introduction
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-to-add-new-machine">
    How to add new machine??
  </a>
<nav aria-label="How to add new machine??" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#cnc-machine-with-mtlinki">
    CNC machine with MtLinki
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#spm-machines">
    SPM machines
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-to-change-anomaly-detection-algorithm-for-dynamic-parameters">
    How to change anomaly detection algorithm for dynamic parameters??
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-to-remove-existing-axisparameter-of-a-machine">
    How to remove existing axis/parameter of a machine??
  </a>
<nav aria-label="How to remove existing axis/parameter of a machine??" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#cnc-machine-with-mtlinki_1">
    CNC machine with MtLinki
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-to-restart-services-and-check-it-status">
    How to restart services (and check it status)??
  </a>
<nav aria-label="How to restart services (and check it status)??" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#check-the-status">
    Check the Status
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#restart-the-service">
    Restart the Service
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="troubleshooting-faq">Troubleshooting &amp; FAQ</h1>
<h2 id="introduction">Introduction</h2>
<p>This section shows some of the common problems that you might face, and how to quickly solve them.</p>
<h2 id="how-to-add-new-machine">How to add new machine??</h2>
<h3 id="cnc-machine-with-mtlinki">CNC machine with MtLinki</h3>
<p>There are some modifications that need to be done to the collector</p>
<ul>
<li>
<p><strong><em>Collector</em></strong>:</p>
<p>If the machine is already connected to the MtLinki, then there are few steps that needs to followed:</p>
<ul>
<li><strong>STEP 1:</strong> Add the machine to the <em>machines</em> table</li>
</ul>
<p><a class="glightbox" data-desc-position="bottom" data-description="" data-height="auto" data-title="" data-width="100%" href="../images/insert_new_machine.png"><img align="center" alt="Adding New Machine to Database" src="../images/insert_new_machine.png"/></a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can omit the id and enabled column while inserting (creating) a new machine, since these will be set to default values automcatically.</p>
</div>
<ul>
<li><strong>STEP 2:</strong> Add its parameters to the <em>machine_parameters</em> table</li>
</ul>
<p><a class="glightbox" data-desc-position="bottom" data-description="" data-height="auto" data-title="" data-width="100%" href="../images/insert_new_parameters.png"><img align="center" alt="Adding New Parameters" src="../images/insert_new_parameters.png"/></a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can omit the id column, omit the critical and warning limts if the parameter is of type dynamic, and omit reference signal if its of type static. Make sure to insert the correct machine_id (corresponds to the id of the machine created at previous step and can be found by querying from the <em>machines</em> table), parameter_group_id (refer to the <em>parameters_group</em> table to find the corresponding id for the paramter group), unit_id (corresponds to the row id of the <em>units</em> table, if the requried unit is not available create (insert) a new unit or use no units as temporary unit) and parameter type. And also make sure that you insert the parameters into the table in right order(corresponding to its axis names), it is the same order that you want it to be displayed in the front end or as given in the machining axis document. The parameter name should be same as the signalname in MtLinki Mongodb.<strong>The parameter name should be unique in the database</strong>, if the name is not unique, add the machine name along with the parameter, such as "carrier gas_laser_cladding_jop199".</p>
</div>
<ul>
<li><strong>STEP 3:</strong> Restart the <em>static and dynamic collector</em> services (as shown in the following sections).</li>
</ul>
</li>
<li>
<p><strong><em>Front End</em></strong>:</p>
<p>All the information related to machines and their parameters can be configured by modifying the <em>config.ts</em> file.:</p>
<ul>
<li><strong>STEP 1:</strong> Open the config.ts file</li>
</ul>
<p><a class="glightbox" data-desc-position="bottom" data-description="" data-height="auto" data-title="" data-width="100%" href="../images/config_ts_file.png"><img align="center" alt="Config File Location" src="../images/config_ts_file.png"/></a></p>
<p>The config.ts file is located in the following location (the front end code needs to be downloaded from the github and opened in any editor) from the root directory of the project.</p>
<pre><code>/src/models/configs.ts
</code></pre>
<ul>
<li><strong>STEP 2:</strong> Modify the config object</li>
</ul>
<p><a class="glightbox" data-desc-position="bottom" data-description="" data-height="auto" data-title="" data-width="100%" href="../images/config_object.png"><img align="center" alt="Config Object" src="../images/config_object.png"/></a></p>
<p>The config object in this file represents the configuration parameters for the front end elements. This object has a property <em>machinetypes</em>. This needs to be modified. This organizes the machines into sections, you can add new machine and their corresponding axis/parameters names under the corresponding section. For example to add new machine "T_H_OP6666", add the following code to the machines property under the section head.</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"T_H_OP6666"</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">"axes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"X"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Y"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Z"</span><span class="p">,</span><span class="w"> </span><span class="s2">"X1"</span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>The key point to note is, <strong>the axes names should be ordered exactly how the appear (inserted) in the database, under the table machine_parameters</strong>, but the name could differ, such as ServoLoad_1_path1_T_H_OP6666 could be mapped to X1 (but the ordering should be same, i.e ServoLoad_1_path1_T_H_OP6666 should be the fourth parameter for this machine in this parameter group (servo and spinle load) when orderded(in ascending) by the id in the machine_paramters table)</p>
<p><a class="glightbox" data-desc-position="bottom" data-description="" data-height="auto" data-title="" data-width="100%" href="../images/add_machine.png"><img align="center" alt="Machine Types Object" src="../images/add_machine.png"/></a></p>
<ul>
<li><strong>STEP 3:</strong> Build the front end code and deploy.</li>
</ul>
<p>Run the following command (from your vs code terminal)</p>
<p><div class="highlight"><pre><span></span><code>npm run build
</code></pre></div>
This will generate the build files.</p>
<p>The contents of the build files need to be copied to the apache server location</p>
<pre><code>/var/www/tnga_iot
</code></pre>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Copy the contents of the apache server directory to any new folder before moving the new build files, so that if the new build doesn't work as intened, you could replace it back with original files.</p>
</div>
<p>Press <em>ctrl + F5</em> , in the front to force refresh the web page to reflect the new changes. </p>
</li>
<li>
<p><strong><em>Back End</em></strong>:</p>
<p>The back need to not be modified, it is self containted and reacts automatically to any changes happening to the collector and front end.</p>
</li>
</ul>
<h3 id="spm-machines">SPM machines</h3>
<p>These machine need a more custom solution as detailed below.</p>
<ul>
<li>
<p><strong><em>Collector</em></strong>:</p>
<p>The collector has to be developed based on how the data is available for the machine, it could be log files, proprietary api (such as haas mdc, fanuc focas). The user has to develop scripts to continuous monitor the machine for new data and add those data to the timescale database. There is no general script for it but there are certain guidelines that needs to be followed while developing the custom script for the spm machines.</p>
<ul>
<li><strong>STEP 1:</strong> Add the machine to the <em>machines</em> table</li>
</ul>
<p><a class="glightbox" data-desc-position="bottom" data-description="" data-height="auto" data-title="" data-width="100%" href="../images/insert_new_machine.png"><img align="center" alt="Adding New Machine to Database" src="../images/insert_new_machine.png"/></a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can omit the id and enabled column while inserting (creating) a new machine, since these will be set to default values automcatically.</p>
</div>
<ul>
<li><strong>STEP 2:</strong> Add its parameters to the <em>machine_parameters</em> table</li>
</ul>
<p><a class="glightbox" data-desc-position="bottom" data-description="" data-height="auto" data-title="" data-width="100%" href="../images/insert_new_parameters.png"><img align="center" alt="Adding New Parameters" src="../images/insert_new_parameters.png"/></a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can omit the id column, omit the critical and warning limts if the parameter is of type dynamic, and omit reference signal if its of type static. Make sure to insert the correct machine_id (corresponds to the id of the machine created at previous step and can be found by querying from the <em>machines</em> table), <strong>you can omit the parameter_group_id since they are not applicable for spm machines</strong>, unit_id (corresponds to the row id of the <em>units</em> table, if the requried unit is not available create (insert) a new unit or use no units as temporary unit) and parameter type (<strong> "spm_static" for static paramter,and "spm_dynamic" for dynamic paramters</strong>). And also make sure that you insert the parameters into the table in right order(corresponding to its axis names), it is the same order that you want it to be displayed in the front end or as given in the machining axis document. <strong>The parameter name should be unique in the database</strong>, if the name is not unique, add the machine name along with the parameter, such as "carrier gas_laser_cladding_jop199".</p>
</div>
<ul>
<li>
<p><strong>STEP 3:</strong> Data format:</p>
<p>The raw data from the machine, (either in log files or other format) need to be transformed to have four columns "time", "machine_parameters_id", "value", "condition_id", where the machine_parameters_id is the id of the row corresponding to the machine parameter in the machine parameters table, and condition id can take values "1", "2", or "3", corresponding to the id of rows from the parameter_conditions table. Once these format is transformed, they need to be inserted into <em>real_time_machine_parameters</em> table. For the <em>real_time_machine_parameters_active</em> table only the recent most data need to be <strong>updated</strong>. The key point is, the new data needs to be inserted/added to the <em>real_time_machine_parameters</em> table, but the recent most data need to replace the old data by updating the corresponding row (for that specific parameter) in the <em>real_time_machine_parameters_active</em> table.</p>
</li>
</ul>
</li>
<li>
<p><strong><em>Front End</em></strong>:</p>
<p>All the information related to machines and their parameters can be configured by modifying the <em>config.ts</em> file.:</p>
<ul>
<li><strong>STEP 1:</strong> Open the config.ts file</li>
</ul>
<p><a class="glightbox" data-desc-position="bottom" data-description="" data-height="auto" data-title="" data-width="100%" href="../images/config_ts_file.png"><img align="center" alt="Config File Location" src="../images/config_ts_file.png"/></a></p>
<p>The config.ts file is located in the following location (the front end code needs to be downloaded from the github and opened in any editor) from the root directory of the project.</p>
<pre><code>/src/models/configs.ts
</code></pre>
<ul>
<li><strong>STEP 2:</strong> Modify the config object</li>
</ul>
<p><a class="glightbox" data-desc-position="bottom" data-description="" data-height="auto" data-title="" data-width="100%" href="../images/config_object.png"><img align="center" alt="Config Object" src="../images/config_object.png"/></a></p>
<p>The config object in this file represents the configuration parameters for the front end elements. This object has a property <em>machinetypes</em>. This needs to be modified. This organizes the machines into sections, you can add new machine and their corresponding axis/parameters names under the corresponding section. For example to add new machine "T_H_OP6666", add the following code to the machines property under the section head.</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"T_H_OP6666"</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">"axes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"X"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Y"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Z"</span><span class="p">,</span><span class="w"> </span><span class="s2">"X1"</span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>The key point to note is, <strong>the axes names should be ordered exactly how the appear (inserted) in the database, under the table machine_parameters</strong>, but the name could differ, such as ServoLoad_1_path1_T_H_OP6666 could be mapped to X1 (but the ordering should be same, i.e ServoLoad_1_path1_T_H_OP6666 should be the fourth parameter for this machine in this parameter group (servo and spinle load) when orderded(in ascending) by the id in the machine_paramters table)</p>
<p><a class="glightbox" data-desc-position="bottom" data-description="" data-height="auto" data-title="" data-width="100%" href="../images/add_machine.png"><img align="center" alt="Machine Types Object" src="../images/add_machine.png"/></a></p>
<ul>
<li>
<p><strong>STEP 3:</strong> Build the front end code and deploy.</p>
<p>Run the following command (from your vs code terminal)</p>
<p><div class="highlight"><pre><span></span><code>npm run build
</code></pre></div>
This will generate the build files.</p>
<p>The contents of the build files need to be copied to the apache server location</p>
<pre><code>/var/www/tnga_iot
</code></pre>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Copy the contents of the apache server directory to any new folder before moving the new build files, so that if the new build doesn't work as intened, you could replace it back with original files.</p>
</div>
<p>Press <em>ctrl + F5</em> , in the front to force refresh the web page to reflect the new changes. </p>
</li>
</ul>
</li>
<li>
<p><strong><em>Back End</em></strong>:</p>
<p>The back need to not be modified, it is self containted and reacts automatically to any changes happening to the collector and front end.</p>
</li>
</ul>
<h2 id="how-to-change-anomaly-detection-algorithm-for-dynamic-parameters">How to change anomaly detection algorithm for dynamic parameters??</h2>
<p>All the anomaly detection task are carried out in the module <em>anomaly_detection</em> within the main application (be it cnc data collector, laser cladding collector etc).</p>
<p>The structure of that module is shown below:</p>
<p><a class="glightbox" data-desc-position="bottom" data-description="" data-height="auto" data-title="" data-width="100%" href="../images/tiei_20.png"><img align="center" alt="Anomaly Detection Module Structure - CNC Collector" src="../images/tiei_20.png"/></a></p>
<p><a class="glightbox" data-desc-position="bottom" data-description="" data-height="auto" data-title="" data-width="100%" href="../images/tiei_21.png"><img align="center" alt="Anomaly Detection Module Structure - SPM Collector" src="../images/tiei_21.png"/></a></p>
<p>As seen in the above pictures the function that carries out the detection method (kruskal method here) is implemented in the <em>detection_algorithm.py</em> script</p>
<p>The contents of this function can be changed to use a different algorithm.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Do not change the function name (even if the new algorithm has different name) to ease out the transition to new algorithm.</p>
</div>
<p>Any new algorithm should follow the following guidelines:</p>
<ul>
<li>
<p>It Should accept a refence signal</p>
</li>
<li>
<p>It should accept sample signal</p>
</li>
<li>
<p>It should accept a threshold value (if not can use a default value of zero)</p>
</li>
<li>
<p>Should return <strong>3</strong> if the condition of the sample signal is classified as abnormal/critical</p>
</li>
<li>
<p>Should return <strong>2</strong> if the condition of the sample signal is classified as warning</p>
</li>
<li>
<p>Should return <strong>1</strong> if the condition of the sample signal is classified as normal</p>
</li>
</ul>
<p>This function is used in the following places as shown below</p>
<p><a class="glightbox" data-desc-position="bottom" data-description="" data-height="auto" data-title="" data-width="100%" href="../images/tiei_22.png"><img align="center" alt="Anomaly Detection Module Structure - CNC Collector Usage" src="../images/tiei_22.png"/></a></p>
<p><a class="glightbox" data-desc-position="bottom" data-description="" data-height="auto" data-title="" data-width="100%" href="../images/tiei_23.png"><img align="center" alt="Anomaly Detection Module Structure - SPM Collector Usage -1" src="../images/tiei_23.png"/></a></p>
<p><a class="glightbox" data-desc-position="bottom" data-description="" data-height="auto" data-title="" data-width="100%" href="../images/tiei_24.png"><img align="center" alt="Anomaly Detection Module Structure - SPM Collector Usage -2" src="../images/tiei_24.png"/></a></p>
<p>If in case you want to change the algorithm to other advanced algorithm, with different set of arguments, then you could change the function (and its name) and call that function with appropriate signature in the above mentioned places.</p>
<h2 id="how-to-remove-existing-axisparameter-of-a-machine">How to remove existing axis/parameter of a machine??</h2>
<h3 id="cnc-machine-with-mtlinki_1">CNC machine with MtLinki</h3>
<p>There are some modifications that need to be done to the timescale db</p>
<ul>
<li>
<p><strong><em>Timescale DB</em></strong>:</p>
<ul>
<li>
<p><strong>STEP 1:</strong> Delete all realtime data and realtime active data corresponding to the axis/parameter:</p>
<p>The corresponding parameter's id needs to found and their records in the real_time_machine_parameters and real_time_machine_parameters_active table needs to be deleted</p>
<p>Use the following code to find the id of the parameter:</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">warning_limit</span><span class="p">,</span><span class="w"> </span><span class="n">critical_limit</span><span class="p">,</span><span class="w"> </span><span class="n">reference_signal</span><span class="p">,</span><span class="w"> </span><span class="n">unit_id</span><span class="p">,</span><span class="w"> </span><span class="n">parameter_group_id</span><span class="p">,</span><span class="w"> </span><span class="n">machine_id</span><span class="p">,</span><span class="w"> </span><span class="n">parameter_type</span><span class="w"></span>
<span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">tiei_sample_4</span><span class="p">.</span><span class="n">machine_parameters</span><span class="w"></span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'CncFan1Speed_path1_T_B_OP180'</span><span class="w"></span>
</code></pre></div>
<p>where you should replace <em>CncFan1Speed_path1_T_B_OP180</em> with the <strong>actual name of the parameter as stored in MtLink in Mongodb</strong>.</p>
<p>Use the following code to delete all the records from the realtime_machine_parameters tables:</p>
<div class="highlight"><pre><span></span><code><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">tiei_sample_4</span><span class="p">.</span><span class="n">real_time_machine_parameters</span><span class="w"></span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">machine_parameters_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">163</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>where you should replace 163 with the <strong>id of the parameter returned from the previous search</strong>.</p>
<p>Use the following code to delete all the records from the realtime_machine_parameters_active tables:</p>
<div class="highlight"><pre><span></span><code><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">tiei_sample_4</span><span class="p">.</span><span class="n">real_time_machine_parameters_active</span><span class="w"></span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">machine_parameters_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">163</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>where you should replace 163 with the <strong>id of the parameter returned from the previous search</strong>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Be cautious when using the above commands as they will delete all records from the table, if important parameter data are deleted, then they cannot be recovered.</p>
</div>
<ul>
<li><strong>STEP 2:</strong> Delete the Parameter from MtLinki MongoDB</li>
</ul>
<p>This is important step, the parameter needs to be deleted from the mongodb also, else the collector will throw error.</p>
<ul>
<li><strong>STEP 3:</strong> Restart the <em>static and dynamic collector</em> services (as shown in the following sections).</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong><em>Front End</em></strong>:</p>
<p>All the information related to machines and their parameters can be configured by modifying the <em>config.ts</em> file.:</p>
<ul>
<li>
<p><strong>STEP 1:</strong> Open the config.ts file</p>
<p><a class="glightbox" data-desc-position="bottom" data-description="" data-height="auto" data-title="" data-width="100%" href="../images/config_ts_file.png"><img align="center" alt="Config File Location" src="../images/config_ts_file.png"/></a></p>
<p>The config.ts file is located in the following location (the front end code needs to be downloaded from the github and opened in any editor) from the root directory of the project.</p>
<pre><code>/src/models/configs.ts
</code></pre>
</li>
<li>
<p><strong>STEP 2:</strong> Modify the config object</p>
<p><a class="glightbox" data-desc-position="bottom" data-description="" data-height="auto" data-title="" data-width="100%" href="../images/config_object.png"><img align="center" alt="Config Object" src="../images/config_object.png"/></a></p>
<p>The config object in this file represents the configuration parameters for the front end elements. This object has a property <em>machinetypes</em>. This needs to be modified. This organizes the machines into sections, you can remove axis/parameters names under the corresponding section. For example to remove "X" axis from the machine "T_H_OP6666", the following modification has to be done to the machines property under the section head.</p>
<ol>
<li>
<p>Before</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"T_H_OP6666"</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">"axes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"X"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Y"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Z"</span><span class="p">,</span><span class="w"> </span><span class="s2">"X1"</span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
</code></pre></div>
</li>
<li>
<p>After</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"T_H_OP6666"</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">"axes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"Y"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Z"</span><span class="p">,</span><span class="w"> </span><span class="s2">"X1"</span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
</code></pre></div>
</li>
</ol>
</li>
<li>
<p><strong>STEP 3:</strong> Build the front end code and deploy.</p>
<p>Run the following command (from your vs code terminal)</p>
<p><div class="highlight"><pre><span></span><code>npm run build
</code></pre></div>
This will generate the build files.</p>
<p>The contents of the build files need to be copied to the apache server location</p>
<pre><code>/var/www/tnga_iot
</code></pre>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Copy the contents of the apache server directory to any new folder before moving the new build files, so that if the new build doesn't work as intened, you could replace it back with original files.</p>
</div>
<p>Press <em>ctrl + F5</em> , in the front to force refresh the web page to reflect the new changes. 
- <strong><em>Back End</em></strong>:</p>
</li>
</ul>
<p>The back need to not be modified, it is self containted and reacts automatically to any changes happening to the collector and front end.</p>
</li>
</ul>
<h2 id="how-to-restart-services-and-check-it-status">How to restart services (and check it status)??</h2>
<h3 id="check-the-status">Check the Status</h3>
<p>The following code can be used to check the status of any service</p>
<div class="highlight"><pre><span></span><code>systemctl status static_collector
</code></pre></div>
<p>You could replace the <em>static_collector</em> with the service you want to check.</p>
<p>The following images shows the result of using that command</p>
<p><a class="glightbox" data-desc-position="bottom" data-description="" data-height="auto" data-title="" data-width="100%" href="../images/tiei_25.png"><img align="center" alt="Service Status - Part Count" src="../images/tiei_25.png"/></a></p>
<p><a class="glightbox" data-desc-position="bottom" data-description="" data-height="auto" data-title="" data-width="100%" href="../images/tiei_26.png"><img align="center" alt="Service Status - Part Count " src="../images/tiei_26.png"/></a></p>
<p>You shall press <em>ctrl + c</em> to get back your terminal from the service status (if required).</p>
<h3 id="restart-the-service">Restart the Service</h3>
<p>The following code can be used to restart any service</p>
<div class="highlight"><pre><span></span><code>systemctl restart static_collector
</code></pre></div>
<p>You could replace the <em>static_collector</em> with the service you want to restart.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Once in a while you can check the status of all services, or if in case there is any issue you can check all the services and try restarting any service that is inactive/dead. If nothing else works, you can always contact CMTI, We're happy to help! üòÉ ü§ùüèª</p>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: KPIs Calculations (CMTI)" class="md-footer__link md-footer__link--prev" href="../Project%20Knowledge/KPI%20Calculations%20%28CMTI%29/" rel="prev">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</div>
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Previous
              </span>
              KPIs Calculations (CMTI)
            </div>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      For the Love of Manufacturing ‚ù§Ô∏è
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.5bf1dace.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
<script src="../assets/javascripts/bundle.078830c0.min.js"></script>
<script src="../javascripts/mathjax.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom"});})</script></body>
</html>